
---
## 1. 传统关系型数据库 (RDBMS) 基础

### 1.1 SQL (Structured Query Language)
- **定义**: 结构化查询语言，是关系型数据库的**标准语言**和**标准接口**。
- **核心功能**:
  - **数据查询**: `SELECT`
  - **数据操作**: `INSERT`, `UPDATE`, `DELETE`
  - **数据定义**: `CREATE`, `ALTER`, `DROP`
  - **数据控制**: `GRANT`, `REVOKE`

### 1.2 事务 (Transaction) & ACID 特性
- **事务定义**: 由一系列数据库操作组成的**逻辑执行单元**，要么全部成功，要么全部失败。
- **事务目的**:
  1.  **故障恢复**: 提供从失败中恢复到正常状态的方法。
  2.  **并发隔离**: 在多个应用并发访问时，防止操作互相干扰。
- **ACID 特性**:
  - **原子性 (Atomicity)**: 事务中的所有操作，**要么都做，要么都不做**。
  - **一致性 (Consistency)**: 事务执行后，数据库从一个一致性状态转移到另一个一致性状态。
  - **隔离性 (Isolation)**: 一个事务的执行不应被其他事务干扰，各事务**相互隔离**。
  - **持久性 (Durability)**: 事务一旦提交，其对数据的改变就是**永久性**的。

---

## **2. 传统关系型数据库的困境**

1.  **水平扩展困难**:
    - 依赖**垂直扩展**（升级服务器硬件）。
    - **水平扩展**（分库分表）实施复杂，涉及分布式事务、跨节点JOIN等难题。

2.  **海量数据性能压力**:
    - 数据量达 TB/PB 级时，大量 JOIN 查询和索引维护导致性能下降。
    - 单机 I/O 成为瓶颈。

3.  **灵活性不足**:
    - 需要**固定模式 (Schema)**，修改表结构成本高。
    - 对 JSON、日志等半结构化或非结构化数据支持不佳。

4.  **高并发写入压力**:
    - 严格的 ACID 特性带来锁机制、阻塞、死锁等问题，影响写入性能。
    - 为保证一致性，牺牲了吞吐量。

5.  **成本高**:
    - 商业数据库（如 Oracle）许可费用昂贵。
    - 开源数据库（如 MySQL）大规模水平扩展的硬件和运维成本高。

---

## **3. NoSQL 数据库**

### **3.1 NoSQL 介绍**
- **定义**: **N**ot **O**nly **SQL**（不仅仅是SQL），泛指**非关系型数据库**。
- **目的**: 解决传统关系型数据库在超大规模数据和高并发场景下的扩展性与性能问题。

### **3.2 NoSQL 分类**
- **Key-Value 数据库**:
  - **特点**: 极高的并发读写性能。
  - **代表**: **Redis**、Memcached。
- **面向文档数据库**:
  - **特点**: 在海量数据中快速查询，通常使用 JSON 格式。
  - **代表**: **MongoDB**、CouchDB。
- **搜索引擎数据库**:
  - **特点**: 专用于数据内容的近实时搜索与分析。
  - **代表**: **Elasticsearch**、Solr。
- **分布式数据库 (列式存储)**:
  - **特点**: 面向可扩展性设计。
  - **代表**: HBase、Cassandra。

### **3.3 CAP 理论 (NoSQL 核心理论)**
- **定义**: 一个分布式系统不可能同时满足以下三个基本需求，最多只能满足其中两项。
- **三个要素**:
  - **C (Consistency)**: **一致性**。所有节点在同一时间的数据完全一致。
  - **A (Availability)**: **可用性**。每次请求都能收到一个非错的响应，但不保证是最新数据。
  - **P (Partition tolerance)**: **分区容错性**。系统在网络分区或节点故障时，仍能继续提供服务。
- **核心权衡**: 分布式系统必须保证 **P (分区容错性)**，因此只能在 **C (一致性)** 和 **A (可用性)** 之间进行取舍。

---

## **4. SQL 与 NoSQL 主要区别**

| 对比维度 | SQL (关系型数据库) | NoSQL (非关系型数据库) |
| :--- | :--- | :--- |
| **数据模型** | 表格结构，固定模式 | 键值、文档、图等，动态模式 |
| **模式 Schema** | 严格，需提前定义 | 灵活，可随时修改 |
| **扩展性** | 垂直扩展为主，水平扩展复杂 | 天然支持水平扩展和分布式 |
| **事务支持** | **ACID** 强一致性 | **最终一致性**，部分支持事务 |
| **查询语言** | 标准 SQL | API 或特定查询语言，不统一 |
| **性能** | 复杂查询效率高，单机性能有限 | 高吞吐、低延迟，适合高并发 |
| **适用场景** | ERP、财务系统等结构化业务 | 大数据、社交网络、缓存、日志等 |
| **数据库代表** | MySQL, Oracle, PostgreSQL | Redis, MongoDB, HBase |

---

## **5. 缓存数据库**

### **5.1 为什么需要缓存数据库？**
1.  **提高响应速度**:
    - 数据存储在**内存**中，读写速度比磁盘数据库快数十甚至上百倍。
2.  **减轻主数据库压力**:
    - 将热点数据放入缓存，减少对后端数据库的直接访问，避免其成为系统瓶颈。
3.  **支撑高并发**:
    - 能够快速响应海量请求（如秒杀、直播），支持百万级 QPS（每秒查询率）。
4.  **降低成本**:
    - 通过缓存减少对昂贵后端数据库的扩容需求，节省 I/O 和服务器资源。

---

## **6. Redis 介绍**

### **6.1 Redis 是什么？**
- **全称**: **Re**mote **Di**ctionary **S**erver (远程字典服务器)。
- **本质**: 一个开源的、高性能的、基于**内存**的 **Key-Value** 数据库。
- **特点**:
  - **极高速度**: 所有数据在内存中，读写速度可达 **10万 ~ 100万 QPS**。
  - **丰富的数据结构**: 支持 String, List, Hash, Set, Sorted Set 等。
  - **多功能**: 不仅是缓存，还支持**持久化**、**分布式**、**消息队列**等功能。

### **6.2 Redis 典型应用场景**
- **数据库缓存**: 加速数据访问，降低后端压力。
- **排行榜**: 利用有序集合（Sorted Set）实现实时排名。
- **计数器应用**: 如文章浏览数、视频播放数。
- **消息队列**: 实现简单的发布/订阅功能。
- **社交网络**: 存储点赞、粉丝、关注等关系数据。

### **6.3 Redis 典型架构场景演进**
1.  **单体架构**: 业务量小，单台 MySQL 即可。
2.  **主从架构**: 流量增大，采用 MySQL 主从复制，实现读写分离。
3.  **引入缓存**: 读请求压力过大时，在应用和数据库从库之间加入 **Redis** 作为缓存层。
    - **查询流程**:
      1. 应用先查询 **Redis**。
      2. 如果 Redis 中有数据（命中），直接返回。
      3. 如果 Redis 中没有数据（未命中），则查询数据库，将结果返回给应用，并**同时写入 Redis**，供下次查询使用。